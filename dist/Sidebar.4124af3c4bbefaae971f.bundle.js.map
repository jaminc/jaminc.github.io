{"version":3,"sources":["webpack:///./src/js/sidebar/Sidebar.js"],"names":["Sidebar","options","Object","assign","this","bindUIElements","sidebarContainer","document","getElementById","sidebarButton","sectionLinksContainer","sectionLinks","Array","from","getElementsByClassName","addEventListener","e","stopPropagation","onClickSidebarButton","bind","onKeyup","onKeydown","body","closeSidebar","onClickSectionLink","setSectionLinksFocusable","isOpen","listenToChangeToSmallWidth","model","subscribeToSidebarOpenState","onChangeSideBarOpenState","enable","tabIndex","forEach","link","isSmallWidth","toggleSidebar","focus","updateSidebarOpenState","classList","add","remove","style","paddingRight","requestState","SCROLLBAR_WIDTH","SIDEBAR_OPEN_STATE","event","preventDefault","target","dataset","window","location","hash","key","ESCAPE_KEY","shiftKey","focusableSideBarElements","querySelectorAll","firstFocusable","lastFocusable","length","TAB_KEY","activeElement"],"mappings":"6XAWMA,E,WACJ,aAA0B,IAAdC,EAAc,uDAAJ,GAAI,UACxBC,OAAOC,OAAOC,KAAMH,GACpBG,KAAKC,iB,qDAGP,WACED,KAAKE,iBAAmBC,SAASC,eAAe,qBAChDJ,KAAKK,cAAgBF,SAASC,eAAe,0BAC7CJ,KAAKM,sBAAwBH,SAASC,eAAe,iBACrDJ,KAAKO,aAAeC,MAAMC,KAAKN,SAASO,uBAAuB,mB,mBAGjE,WAAQ,WAoBN,OAnBAV,KAAKE,iBAAiBS,iBAAiB,SAAS,SAACC,GAAD,OAAOA,EAAEC,qBACzDb,KAAKK,cAAcM,iBAAiB,QAASX,KAAKc,qBAAqBC,KAAKf,OAE5EA,KAAKE,iBAAiBS,iBAAiB,YAAY,SAACC,GAAD,OAAOA,EAAEC,qBAE5DV,SAASQ,iBAAiB,QAASX,KAAKgB,QAAQD,KAAKf,OACrDG,SAASQ,iBAAiB,UAAWX,KAAKiB,UAAUF,KAAKf,OAEzDG,SAASe,KAAKP,iBAAiB,SAAS,kBAAM,EAAKQ,kBAEnDhB,SAASe,KAAKP,iBAAiB,YAAY,kBAAM,EAAKQ,kBAEtDnB,KAAKM,sBAAsBK,iBAAiB,QAASX,KAAKoB,mBAAmBL,KAAKf,OAElFA,KAAKqB,2BAA2BrB,KAAKsB,UAErCC,aAA2B,kBAAM,EAAKJ,kBACtCnB,KAAKwB,MAAMC,4BAA4BzB,KAAK0B,yBAAyBX,KAAKf,OAEnEA,O,sCAGT,SAAyB2B,GACvB,IAAMC,EAAWD,EAAS,GAAK,EAE/B3B,KAAKO,aAAasB,SAAQ,SAACC,GAAD,OAAUhC,OAAOC,OAAO+B,EAAM,CAAEF,kB,0BAG5D,WACOG,eAID/B,KAAKsB,WACPtB,KAAKgC,gBACLhC,KAAKK,cAAc4B,W,2BAIvB,WACEjC,KAAKwB,MAAMU,wBAAwBlC,KAAKsB,Y,sCAG1C,SAAyBA,GACvBtB,KAAKqB,yBAAyBC,GAE1BA,GACFnB,SAASe,KAAKiB,UAAUC,IAAI,QAC5BpC,KAAKO,aAAa,GAAG0B,SAErB9B,SAASe,KAAKiB,UAAUE,OAAO,QAGjClC,SAASe,KAAKoB,MAAMC,aAAejB,EAAM,UAClCtB,KAAKwB,MAAMgB,aAAaC,KADU,MAErC,K,oBAGN,WACE,OAAOzC,KAAKwB,MAAMgB,aAAaE,O,kCAGjC,SAAqBC,GACnBA,EAAM9B,kBAENb,KAAKgC,kB,gCAGP,SAAmBW,GACjBA,EAAMC,iBACN,IAAQC,EAAWF,EAAME,OAAOC,QAAxBD,OAERE,OAAOC,SAASC,KAAOJ,EAEvB7C,KAAKmB,iB,qBAGP,SAAQwB,GACFA,EAAMO,MAAQC,KAChBnD,KAAKmB,iB,uBAIT,SAAUwB,GACR,GAAKZ,eAAmB/B,KAAKsB,SAA7B,CAIA,IAAQ4B,EAAkBP,EAAlBO,IAAKE,EAAaT,EAAbS,SAEbpD,KAAKqD,yBAA2BrD,KAAKqD,0BAChCrD,KAAKE,iBAAiBoD,iBAAiB,4EAC5C,IAAMC,EAAiBvD,KAAKqD,yBAAyB,GAC/CG,EAAgBxD,KAAKqD,yBAAyBrD,KAAKqD,yBAAyBI,OAAS,GAEvFP,IAAQQ,MACNN,GAAYjD,SAASwD,gBAAkBJ,GACzCZ,EAAMC,iBACNY,EAAcvB,SACJmB,GAAYjD,SAASwD,gBAAkBH,IACjDb,EAAMC,iBACNW,EAAetB,gB,mFAMRrC","file":"Sidebar.4124af3c4bbefaae971f.bundle.js","sourcesContent":["import {\n  ESCAPE_KEY,\n  TAB_KEY,\n  SIDEBAR_OPEN_STATE,\n  SCROLLBAR_WIDTH,\n} from '../constants';\nimport {\n  isSmallWidth,\n  listenToChangeToSmallWidth,\n} from '../util/util';\n\nclass Sidebar {\n  constructor(options = {}) {\n    Object.assign(this, options);\n    this.bindUIElements();\n  }\n\n  bindUIElements() {\n    this.sidebarContainer = document.getElementById('sidebar-container');\n    this.sidebarButton = document.getElementById('sidebar-trigger-button');\n    this.sectionLinksContainer = document.getElementById('section-links');\n    this.sectionLinks = Array.from(document.getElementsByClassName('section-link'));\n  }\n\n  start() {\n    this.sidebarContainer.addEventListener('click', (e) => e.stopPropagation());\n    this.sidebarButton.addEventListener('click', this.onClickSidebarButton.bind(this));\n    // Fix for ios\n    this.sidebarContainer.addEventListener('touchend', (e) => e.stopPropagation());\n\n    document.addEventListener('keyup', this.onKeyup.bind(this));\n    document.addEventListener('keydown', this.onKeydown.bind(this));\n\n    document.body.addEventListener('click', () => this.closeSidebar());\n    // Fix for ios\n    document.body.addEventListener('touchend', () => this.closeSidebar());\n\n    this.sectionLinksContainer.addEventListener('click', this.onClickSectionLink.bind(this));\n\n    this.setSectionLinksFocusable(!!this.isOpen());\n\n    listenToChangeToSmallWidth(() => this.closeSidebar());\n    this.model.subscribeToSidebarOpenState(this.onChangeSideBarOpenState.bind(this));\n\n    return this;\n  }\n\n  setSectionLinksFocusable(enable) {\n    const tabIndex = enable ? 1 : -1;\n\n    this.sectionLinks.forEach((link) => Object.assign(link, { tabIndex }));\n  }\n\n  closeSidebar() {\n    if (!isSmallWidth()) {\n      return;\n    }\n\n    if (this.isOpen()) {\n      this.toggleSidebar();\n      this.sidebarButton.focus();\n    }\n  }\n\n  toggleSidebar() {\n    this.model.updateSidebarOpenState(!this.isOpen());\n  }\n\n  onChangeSideBarOpenState(isOpen) {\n    this.setSectionLinksFocusable(isOpen);\n\n    if (isOpen) {\n      document.body.classList.add('show');\n      this.sectionLinks[0].focus();\n    } else {\n      document.body.classList.remove('show');\n    }\n\n    document.body.style.paddingRight = isOpen\n      ? `${this.model.requestState(SCROLLBAR_WIDTH)}px`\n      : '';\n  }\n\n  isOpen() {\n    return this.model.requestState(SIDEBAR_OPEN_STATE);\n  }\n\n  onClickSidebarButton(event) {\n    event.stopPropagation();\n\n    this.toggleSidebar();\n  }\n\n  onClickSectionLink(event) {\n    event.preventDefault();\n    const { target } = event.target.dataset;\n\n    window.location.hash = target;\n\n    this.closeSidebar();\n  }\n\n  onKeyup(event) {\n    if (event.key === ESCAPE_KEY) {\n      this.closeSidebar();\n    }\n  }\n\n  onKeydown(event) {\n    if (!isSmallWidth() || !this.isOpen()) {\n      return;\n    }\n\n    const { key, shiftKey } = event;\n\n    this.focusableSideBarElements = this.focusableSideBarElements\n      || this.sidebarContainer.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n    const firstFocusable = this.focusableSideBarElements[0];\n    const lastFocusable = this.focusableSideBarElements[this.focusableSideBarElements.length - 1];\n\n    if (key === TAB_KEY) {\n      if (shiftKey && document.activeElement === firstFocusable) {\n        event.preventDefault();\n        lastFocusable.focus();\n      } else if (!shiftKey && document.activeElement === lastFocusable) {\n        event.preventDefault();\n        firstFocusable.focus();\n      }\n    }\n  }\n}\n\nexport default Sidebar;\n"],"sourceRoot":""}